{$CLEO .s}
{$USE input}
{$INCLUDE_ONCE ../cleo_tester.inc}

script_name '2086'
test("2086 (get_key_name)", tests)
terminate_this_custom_script

{$OPCODE 2086=2, get key name %1d% %2d%}

function tests
    it("should get key name", test1)
    return
    

    function test1()
        longString nameVar
        
        nameVar = "-oriVal-"
        2086: get_key_name {keyCode} 0x41 nameVar // A
        assert_result_true()
        assert_eqs(nameVar, "A")
        
        nameVar = "-oriVal-"
        2086: get_key_name {keyCode} 0x70 nameVar // F1
        assert_result_true()
        assert_eqs(nameVar, "F1")
        
        nameVar = "-oriVal-"
        2086: get_key_name {keyCode} 0x0D nameVar // VK_RETURN
        assert_result_true()
        assert_eqs(nameVar, "RETURN")
        
        nameVar = "-oriVal-"
        2086: get_key_name {keyCode} 0xA6 nameVar // VK_BROWSER_BACK 
        assert_result_false()
        assert_eqs(nameVar, "-oriVal-") // unmodified
        
        int nameBuff = allocate_memory {size} 32
        string_format {result} nameBuff {format} "-oriVal-"
        2086: get_key_name {keyCode} 0x61 nameVar // VK_NUMPAD1
        assert_result_true()
        assert_eqs(nameVar, "NUM1") // unmodified
        free_memory {address} nameBuff
    end
end
